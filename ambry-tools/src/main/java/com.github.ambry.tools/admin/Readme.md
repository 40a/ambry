## Terminologies:

HardwareLayout   - Has information about the nodes available in the cluster. disks for those nodes and their states
PartitionLayout  - Has information about the partitions and its replicas
Blobid           - BlobId of the blob/object which was generated by ambry on put


## Set up:
To execute this tool, copy all the required jar files to a temp directory. Once you have all the required jar files,
you can execute the following commands from the same directory.


## DumpData
This tool is used to dump the data parsing the storage files.
 
Operations supported:
1. Dumping log file
2. Dumping index file
3. Dumping replicaToken. 
4. Compare index entries to log contents

## BlobValidator
This tool is used to perform read operations for a blob directly from the server. 

Operations supported:
1. List partitions for a blobid
2. Get blob(deserialize blob) for a given blob id for all its replicas
3. Get blob(deserialize blob) for a given blob id for local replicas
4. Get blob(deserialize blob) for a given blob id for the given replica

## AdminTool
This tool exposes some admin APIs to get more information for debugging purposes

Operations supported:
1. List partitions for a blobid

## Examples:

### Dumping Index:

#### Dump Index:
```java
java -cp "*" com.github.ambry.tools.admin.DumpData --hardwareLayout [HardwareLayoutFile]
 --partitionLayout [PartitionLayoutFile] --typeOfFile index --fileToRead [indexFile]
```

#### Dump index filtering for a list of blobs:
```java
java -cp "*" com.github.ambry.tools.admin.DumpData --hardwareLayout [HardwareLayoutFile] --partitionLayout [PartitionLayoutFile]
--typeOfFile index --fileToRead [indexFile] --listOfBlobs [blobid1,blobid2,blobid3]
```

### Dumping Log:

#### Dump log file:
```java
java -cp "*" com.github.ambry.tools.admin.DumpData --hardwareLayout [HardwareLayoutFile]
--partitionLayout [PartitionLayoutFile] --typeOfFile index --fileToRead [logFile]
```

#### Dump log ending at offset x:
```java
java -cp "*" com.github.ambry.tools.admin.DumpData
--hardwareLayout [HardwareLayoutFile] --partitionLayout [PartitionLayoutFile] --typeOfFile index
--fileToRead [logFile] --endOffset x
```

#### Dump log starting at x offset and ending at y filtered with a set of blobs:
```java
java -cp "*" com.github.ambry.tools.admin.DumpData
--hardwareLayout [HardwareLayoutFile] --partitionLayout [PartitionLayoutFile] --typeOfFile index
--fileToRead [logFile] --startOffset x --endOffset y --listOfBlobs [blobid1,blobid2,blobid3]
```

### Comparing index entries to log entries(or in other words, trying to find index entry in the log with index info):
```java
java -cp "*" com.github.ambry.tools.admin.DumpData
--hardwareLayout [HardwareLayoutFile] --partitionLayout [PartitionLayoutFile] --fileToRead [indexFile]
--logFileToDump [logFile]
```


### BlobValidator:

#### Get blob from all replicas:
```java
java -cp "*" com.github.ambry.tools.admin.BlobValidator --hardwareLayout [HardwareLayoutFile]
--partitionLayout [PartitionLayoutFile] --typeOfOperation VALIDATE_BLOB_ON_ALL_REPLICAS --ambryBlobId [blobid]
```

#### Get blob from all replicas from a datecenter:
```java
java -cp "*" com.github.ambry.tools.admin.BlobValidator --hardwareLayout [HardwareLayoutFile]
--partitionLayout [PartitionLayoutFile] --typeOfOperation VALIDATE_BLOB_ON_DATACENTER --fabric [fabric]
--ambryBlobId [blobid]
```

#### Get blob from a replica:
```java
java -cp "*" com.github.ambry.tools.admin.BlobValidator --hardwareLayout [HardwareLayoutFile]
--partitionLayout [PartitionLayoutFile] --typeOfOperation VALIDATE_BLOB_ON_REPLICA --ambryBlobId [blobid]
--replicaHost [replicaHost] --replicaPort [replicaPort]
```

### AdminTool:

#### List Replica:
```java
java -cp "*" com.github.ambry.tools.admin.AdminTool --hardwareLayout [HardwareLayoutFile]
--partitionLayout [PartitionLayoutFile] --typeOfOperation LIST_REPLICAS --ambryBlobId [blobid]
```





